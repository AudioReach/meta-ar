---
name: Load parameters
description: Load parameters for the build job

outputs:
  build_matrix:
    description: Build matrix
    value: ${{ steps.set-matrix.outputs.build_matrix }}

runs:
  using: "composite"
  steps:
    - name: Set build matrix
      id: set-matrix
      uses: actions/github-script@v7
      with:
        script: |
          const file = require('./ci/MACHINES.json');
          const matrix = Object.entries(file).map(([machine, kas_file]) => ({ machine, kas_file }));
          core.setOutput('build_matrix', JSON.stringify(matrix));
